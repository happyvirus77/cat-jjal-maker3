<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>ê³ ì–‘ì´ ê°€ë¼ì‚¬ëŒ€</title>
    <style>
      body { text-align: center; }
      .main-card button { position: relative; left: -45px; bottom: 15px; }
      .favorites { list-style: none; display: flex; justify-content: center; flex-wrap: wrap; gap: 15px; }
      .favorites img { width: 150px; }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>

    <script type="text/babel">
      function CatItem({ img }){
        return(
          <li>
            <img src={img} alt="ê³ ì–‘ì´" style={{width: "150px"}}/>
          </li>
        )
      }

      function Favorites({ favorites = [] }){
        return(
          <ul className="favorites">
            {favorites.map(cat => <CatItem img={cat} key={cat}/>)}
          </ul>
        )
      }

      const MainCard=({ img, onHeartClick })=>(
        <div className="main-card">
          <img src={img} alt="ê³ ì–‘ì´" width="400" />
          <button onClick={onHeartClick}>ğŸ¤</button>
        </div>
      )

      const Title=({ children })=> <h1>{children}</h1>;

      const Form=({ updateMainCat })=>{
        const [value, setValue] = React.useState('');
        const [errorMessage, setErrorMessage] = React.useState('');

        const includesHangul = (text) => /[ã„±-ã…ã…-ã…£ê°€-í£]/.test(text);

        function handleInputChange(e){
          const userValue = e.target.value;
          if (includesHangul(userValue)) {
            setErrorMessage('í•œê¸€ì€ ì…ë ¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
          } else {
            setErrorMessage(''); // í•œê¸€ì´ ì•„ë‹ˆë©´ ì—ëŸ¬ í•´ì œ
          }
          setValue(userValue.toUpperCase());
        }

        function handleFormSubmit(e){
          e.preventDefault();
          if (value.trim() === '') {
            setErrorMessage('ë¹ˆ ê°’ìœ¼ë¡œ ë§Œë“¤ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            return;
          }
          updateMainCat(); // ìœ íš¨í•˜ë©´ ë¶€ëª¨ ì½œë°± í˜¸ì¶œ
        }

        return(
          <form onSubmit={handleFormSubmit}>
            <input
              type="text"
              name="name"
              placeholder="ì˜ì–´ ëŒ€ì‚¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"
              value={value}
              onChange={handleInputChange}
            />
            <button type="submit">ìƒì„±</button>
            <p style={{color: 'red', minHeight: '1em'}}>{errorMessage}</p>
          </form>
        )
      }

      const App=()=>{
        const CAT1="https://cataas.com/cat/HSENVDU4ZMqy7KQ0/says/react";
        const CAT2="https://cataas.com/cat/BxqL2EjFmtxDkAm2/says/inflearn";
        const CAT3="https://cataas.com/cat/18MD6byVC1yKGpXp/says/JavaScript";

        const [counter, setCounter]=React.useState(
          Number(localStorage.getItem('counter'))
        );
        const [mainCat, setMainCat]=React.useState(CAT1);
        const [favorites, setFavorites]=React.useState([CAT1, CAT2, CAT3]);

        // ë¶€ëª¨ ì½œë°±ì€ ì´ë²¤íŠ¸ë¥¼ ë°›ì§€ ì•ŠìŠµë‹ˆë‹¤(ì´ë²¤íŠ¸ ì·¨ì†ŒëŠ” Formì—ì„œ ì²˜ë¦¬)
        const updateMainCat=()=>{
          const nextCounter=counter+1;
          setCounter(nextCounter);
          setMainCat(CAT2);

          localStorage.setItem('counter',nextCounter)
        }

        const handleHeartClick=()=>{
          const nextFavorites=[...favorites, mainCat];
          setFavorites(nextFavorites);
          jsonLocalStorage.setItem("favorites",nextFaovrites)
        }

        return (
          <div>
            <Title>{counter}ë²ˆì§¸ ê³ ì–‘ì´ ê°€ë¼ì‚¬ëŒ€</Title>
            <Form updateMainCat={updateMainCat}/>
            <MainCard img={mainCat} onHeartClick={handleHeartClick}/>
            <Favorites favorites={favorites}/>
          </div>
        )
      }

      const root=ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App/>);
    </script>
  </body>
</html>
